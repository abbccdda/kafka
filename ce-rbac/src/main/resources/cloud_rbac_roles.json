/*
The roles for Confluent Cloud RBAC v1.0.

There are 3 customer-facing roles:

Organization Admin:
- Must be bound at an organization scope or the binding will be rejected
  eg. {"path": ["organization=123"], "clusters": {}}
- Allows administrative privileges on everything within the organization

Environment Admin:
- Must be bound at an environment scope or the binding will be rejected
  eg. {"path": ["organization=123", "environment=t55"], "clusters": {}}
- Allows administrative privileges on everything within a specific environment
- Also allows organization level privileges to assign roles (inviting users, describing
  users and service accounts), and get support

Cloud Cluster Admin:
- Note that this is "Cloud" Cluster Admin to distinguish it from the CP ClusterAdmin role
- A Cloud Cluster is equivalent to Deployment, but it's hidden from end users.
- Since LKC is 1:1 with Deployment, we are using Lkc Id and Cloud Cluster instead of Deployment
  eg. {"path": ["organization=123", "environment=t55", "cloud-cluster="lkc-abc123"],
       "clusters": {}}
- Allows administrative privileges on everything within a specific cluster
- Also allows organization level privileges to assign roles (inviting users, describing
  users and service accounts), and get support

Note: We are using "Organization", "Environment" operation "Describe" to authorize/filter
the GET endpoints for Org and Env. Thus, these are added to CloudClusterAdmin to allow
UI navigation and api access to these higher level resources.

There is also a non-customer-facing role:

CCloudRoleBindingAdmin:
- Used by the cc-flow-service to create Organization Admins for newly-created organizations.


In addition to permissions on the resource that the admin controls, SecurityMetadata
permissions are necessary to allow the admin to set role bindings on scope types other than
Resource.

Unlike Confluent Platform, where all roles are bound at the cluster scope, in Confluent
Cloud, bindings may also be at "higher" scopes. The hierarchy is defined in this document
in the "bindingScopes" key. The value is an *ordered* list of the scopes at which roles
can be bound, from most-specific to most-general.

A role must be bound at the most specific bindingScope of its policies. For example,
the EnvironmentAdmin role has policies with bindingScopes of "organization" and
"environment", and "bindingScopes" tells us that "environment" is more specific,
so the scope used when binding EnvironmentAdmin must be "environment". If and only if
bindWithResource is true for any of a role's policies, that role must be bound with a resource.

*/
{
  "bindingScopes": ["cluster", "cloud-cluster", "environment", "organization", "root"],
  "roles": [
    {
      "name": "CCloudRoleBindingAdmin",
      "policy": {
        "bindingScope": "root",
        "bindWithResource": false,
        "allowedOperations": [
          {
            "resourceType": "Organization",
            "operations": [ "DescribeAccess", "AlterAccess" ]
          },
          {
            "resourceType" : "SecurityMetadata",
            "operations" : ["Describe", "Alter"]
          }
        ]
      }
    },
    {
      "name": "OrganizationAdmin",
      "policies": [
        {
          "bindingScope": "organization",
          "bindWithResource": false,
          "allowedOperations": [
            {
              "resourceType": "Organization",
              "operations": [ "Describe", "Alter", "CreateEnvironment", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "User",
              "operations": [ "Create", "Invite", "Describe", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "ServiceAccount",
              "operations": [ "Create", "Describe", "Alter", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "CloudApiKey",
              "operations": [ "Create", "Describe", "Alter", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "Billing",
              "operations": [ "Describe", "Alter", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "SecuritySSO",
              "operations": [ "Create", "Describe", "Alter", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "SupportPlan",
              "operations": [ "Describe", "Alter", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "Environment",
              "operations": [ "All" ]
            },
            {
              "resourceType": "SchemaRegistry",
              "operations": [ "All" ]
            },
            {
              "resourceType": "CloudCluster",
              "operations": [ "All" ]
            },
            {
              "resourceType": "NetworkRegion",
              "operations": [ "All" ]
            },
            {
              "resourceType": "NetworkConfig",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Cluster",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Topic",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Subject",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Connector",
              "operations": [ "All" ]
            },
            {
              "resourceType": "KsqlCluster",
              "operations": [ "All" ]
            },
            {
              "resourceType": "NetworkAccess",
              "operations": [ "All" ]
            },
            {
              "resourceType": "ClusterApiKey",
              "operations": [ "All" ]
            },
            {
              "resourceType": "ClusterMetric",
              "operations": [ "All" ]
            },
            {
              "resourceType" : "SecurityMetadata",
              "operations" : ["Describe", "Alter"]
            }
          ]
        }
      ]
    },
    {
      "name": "EnvironmentAdmin",
      "policies": [
        {
          "bindingScope": "organization",
          "bindWithResource": false,
          "allowedOperations": [
            {
              "resourceType": "Organization",
              "operations": [ "Describe" ]
            },
            {
              "resourceType": "User",
              "operations": [ "Create", "Invite", "Describe" ]
            },
            {
              "resourceType": "ServiceAccount",
              "operations": [ "Describe" ]
            },
            {
              "resourceType": "SupportPlan",
              "operations": [ "Describe" ]
            }
          ]
        },
        {
          "bindingScope": "environment",
          "bindWithResource": false,
          "allowedOperations": [
            {
              "resourceType": "Environment",
              "operations": [ "Describe", "Alter", "Delete", "CreateCloudCluster", "CreateSRCluster", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "SchemaRegistry",
              "operations": [ "Describe", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "NetworkRegion",
              "operations": [ "Create", "Describe", "Alter", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "NetworkConfig",
              "operations": [ "Create", "Describe", "Alter", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "CloudCluster",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Cluster",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Topic",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Subject",
              "operations": [ "All" ]
            },
            {
              "resourceType": "Connector",
              "operations": [ "All" ]
            },
            {
              "resourceType": "KsqlCluster",
              "operations": [ "All" ]
            },
            {
              "resourceType": "NetworkAccess",
              "operations": [ "All" ]
            },
            {
              "resourceType": "ClusterApiKey",
              "operations": [ "All" ]
            },
            {
              "resourceType": "ClusterMetric",
              "operations": [ "All" ]
            },
            {
              "resourceType" : "SecurityMetadata",
              "operations" : ["Describe", "Alter"]
            }
          ]
        }
      ]
    },
    {
      "name": "CloudClusterAdmin",
      "policies": [
        {
          "bindingScope": "organization",
          "bindWithResource": false,
          "allowedOperations": [
            {
              "resourceType": "Organization",
              "operations": [ "Describe" ]
            },
            {
              "resourceType": "User",
              "operations": [ "Create", "Invite", "Describe" ]
            },
            {
              "resourceType": "ServiceAccount",
              "operations": [ "Describe" ]
            },
            {
              "resourceType": "SupportPlan",
              "operations": [ "Describe" ]
            }
          ]
        },
        {
          "bindingScope": "environment",
          "bindWithResource": false,
          "allowedOperations": [
            {
              "resourceType": "Environment",
              "operations": [ "Describe" ]
            }
          ]
        },
        {
          "bindingScope": "cloud-cluster",
          "bindWithResource": false,
          "allowedOperations": [
            {
              "resourceType": "CloudCluster",
              "operations": [ "Describe", "Alter", "Delete", "CreateKsqlCluster", "CreateKafkaCluster", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "Cluster",
              "operations": [ "Create", "IdempotentWrite", "Describe", "DescribeConfigs", "Alter", "AlterConfigs", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "Topic",
              "operations": [ "Create", "Delete", "Read", "Write", "Describe", "DescribeConfigs", "Alter", "AlterConfigs", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "Subject",
              "operations": [ "Read", "Write", "Delete", "ReadCompatibility", "WriteCompatibility", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "Connector",
              "operations": [ "Create", "ReadConfig", "ReadStatus", "ReadTasks", "Pause", "Resume", "Configure", "Delete", "DescribeMetrics", "DescribePlugins", "ValidateConfig", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "KsqlCluster",
              "operations": [ "Contribute", "Describe", "Alter", "Terminate", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "NetworkAccess",
              "operations": [ "Create", "Describe", "Alter", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "ClusterApiKey",
              "operations": [ "Create", "Describe", "Alter", "Delete", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType": "ClusterMetric",
              "operations": [ "Describe", "Read", "DescribeAccess", "AlterAccess" ]
            },
            {
              "resourceType" : "SecurityMetadata",
              "operations" : ["Describe", "Alter" ]
            }
          ]
        }
      ]
    }
  ]
}